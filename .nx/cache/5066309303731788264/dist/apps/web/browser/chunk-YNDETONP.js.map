{
  "version": 3,
  "sources": ["apps/web/src/app/features/public/pages/login/login.component.ts", "apps/web/src/app/features/public/pages/login/login.component.html"],
  "sourcesContent": ["import { Component, ElementRef, ViewChild, signal, AfterViewInit } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { Router, RouterLink } from '@angular/router';\nimport { AuthService } from '@core/auth.service';\nimport { CaptchaService } from '@core/captcha.service';\nimport { environment } from '@env/environment';\n\n@Component({\n  selector: 'app-login',\n  imports: [FormsModule, RouterLink],\n  templateUrl: './login.component.html',\n  styleUrl: './login.component.scss',\n  host: { class: 'u-centered-flex' },\n})\nexport class LoginComponent implements AfterViewInit {\n  @ViewChild('turnstileContainer') turnstileContainer!: ElementRef;\n\n  email = '';\n  password = '';\n  rememberMe = false;\n  error = signal<string | null>(null);\n  submitting = signal(false);\n  captchaToken = signal<string | null>(null);\n\n  constructor(\n    private readonly auth: AuthService,\n    private readonly router: Router,\n    private readonly captcha: CaptchaService,\n  ) {}\n\n  ngAfterViewInit() {\n    this.captcha.render(\n      this.turnstileContainer.nativeElement,\n      environment.turnstileSiteKey,\n      (token) => {\n        this.captchaToken.set(token);\n      },\n      {\n        appearance: 'always',\n        size: 'invisible',\n      },\n    );\n  }\n\n  async onSubmit() {\n    this.error.set(null);\n    this.submitting.set(true);\n\n    this.auth.setRememberMe(this.rememberMe);\n    const errorMsg = await this.auth.signIn(this.email, this.password, this.captchaToken() ?? undefined);\n    this.submitting.set(false);\n\n    if (errorMsg) {\n      this.error.set(errorMsg);\n      return;\n    }\n\n    const roles = this.auth.roles();\n    if (roles.length === 0) {\n      this.error.set('此帳號尚未被指派角色，請聯繫管理員');\n      return;\n    }\n\n    this.auth.navigateToRoleShell(roles[0]);\n  }\n}\n", "<div class=\"login auth-content\">\n  <header class=\"auth-content__header\">\n    <p class=\"auth-content__badge\">管理系統</p>\n    <h1 class=\"auth-content__title\">登入</h1>\n    <p class=\"auth-content__subtitle\">請使用您的帳號密碼登入管理系統</p>\n  </header>\n\n  <form class=\"form\" (ngSubmit)=\"onSubmit()\">\n    @if (error()) {\n      <div class=\"message message--error\">\n        <i class=\"pi pi-exclamation-circle\"></i>\n        {{ error() }}\n      </div>\n    }\n\n    <div class=\"form__field\">\n      <label class=\"form__label\" for=\"email\">Email</label>\n      <input\n        id=\"email\"\n        type=\"email\"\n        class=\"form__input\"\n        placeholder=\"輸入 Email\"\n        [(ngModel)]=\"email\"\n        name=\"email\"\n        required\n        autocomplete=\"email\"\n      />\n    </div>\n\n    <div class=\"form__field\">\n      <label class=\"form__label\" for=\"password\">密碼</label>\n      <input\n        id=\"password\"\n        type=\"password\"\n        class=\"form__input\"\n        placeholder=\"輸入密碼\"\n        [(ngModel)]=\"password\"\n        name=\"password\"\n        required\n        autocomplete=\"current-password\"\n      />\n    </div>\n\n    <div class=\"form__row\">\n      <label class=\"form__checkbox\">\n        <input type=\"checkbox\" [(ngModel)]=\"rememberMe\" name=\"rememberMe\" />\n        <span>記住我</span>\n      </label>\n      <a class=\"form__link\" routerLink=\"/forgot-password\">忘記密碼？</a>\n    </div>\n\n\n    <div #turnstileContainer class=\"mb-4\"></div>\n\n    <button\n      type=\"submit\"\n      class=\"form__submit\"\n      [disabled]=\"submitting() || !email || !password\"\n    >\n      @if (submitting()) {\n        <i class=\"pi pi-spinner pi-spin\"></i>\n        登入中...\n      } @else {\n        <i class=\"pi pi-sign-in\"></i>\n        登入\n      }\n    </button>\n  </form>\n</div>\n"],
  "mappings": "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",
  "names": []
}
