# 續課管理

**路徑**: `/admin/renewals`
**角色**: Admin
**分組**: 報名管理

## 核心目的

查看續課狀態、處理異動申請。

## MVP 功能

### 續課預覽列表

- 依週期/開課班分組
- 每筆顯示：學生、課程、目前班級、目標班級（若有升班）、費用、狀態
- 狀態標籤：
  - 待開單（藍色）
  - 已開單（綠色）
  - 有異動（暖銅橘）
  - 已失效（灰色）

### 異動申請處理

- 異動類型：
  - 轉班
  - 停課（不續報）
  - 變更繳費方式
- 處理流程：
  1. 檢視異動申請詳情
  2. 聯繫家長確認
  3. 手動調整課程或標記不續課
  4. 完成任務

### 手動開單功能

- 處理異動後，可手動為學生建立正確的繳費單

### 批次操作

- 批次開單（選擇多個學生）
- 批次標記失效

## 資料依賴

| 操作 | 資料表 |
|------|--------|
| 讀取 | `enrollments`, `renewal_requests`, `classes`, `fee_templates`, `billing_periods` |
| 寫入 | `enrollments`, `renewal_requests`, `invoices`, `tasks` |

## PRD 參考

- 4.23 預告制自動續課與繳費通知
- 6.10 續課流程
- 7.5 管理員頁面

## 實作註記

- 需實作年級不符檢查（Grade Mismatch Check）
- 需實作名額檢查（Capacity Check）
- 有異動申請的學生會暫停自動開單
