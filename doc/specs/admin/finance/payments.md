# 繳費紀錄

**路徑**: `/admin/payments`
**角色**: Admin
**分組**: 財務管理

## 核心目的

管理繳費單、確認收款。

## MVP 功能

### 繳費單列表

- 篩選：狀態、日期、學生
- 狀態標籤：
  - 待付款（灰色）
  - 部分付款（暖銅橘）
  - 已付款（綠色）
  - 逾期（紅色）
  - 失效（淺灰）
  - 已取消（淺灰）
  - 已退款（紫色）
- 每筆顯示：繳費單編號、學生、開課班、金額、狀態、期限/付款日

### 確認收款 Popup

1. 輸入付款金額
2. 選擇付款方式（現金/銀行轉帳）
3. 輸入備註（如轉帳帳號末五碼）
4. 選擇本次欲啟用的課程項目（部分付款時）
5. 確認收款

### 強制啟用功能

- 即使金額未付清，管理員仍可強制啟用課程的 Enrollment
- 適用場景：分期付款、賒帳

### 繳費單詳情

- 繳費單編號
- 學生姓名
- 費用明細（項目、金額）
- 折扣/調整
- 應繳金額
- 繳費期限
- 狀態
- 付款紀錄列表

### 操作

- 延長繳費期限
- 取消繳費單
- 標記退款

## 資料依賴

| 操作 | 資料表 |
|------|--------|
| 讀取 | `invoices`, `payment_records`, `students`, `classes`, `enrollments` |
| 寫入 | `invoices`, `payment_records`, `enrollments` |

## PRD 參考

- 4.18 繳費單
- 4.19 繳費紀錄
- 7.5 管理員頁面

## 實作註記

- 部分付款需支援指定啟用課程
- 確認收款後系統自動更新相關狀態
- 若為新生，系統自動建立家長帳號和學生資料
